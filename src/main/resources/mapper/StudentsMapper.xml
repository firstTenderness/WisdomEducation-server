<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.dream.mapper.StudentsMapper">
    <select id="list" resultType="com.dream.pojo.Students">
    <!--          写学生的分页查询包含模糊查询名字和年级多表查询包括班级-->
        SELECT
        p.id AS student_id,
        p.name AS student_name,
        p.gender,
        p.age,
        p.phone,
        c.class_name,
        c.grade
        FROM
        person p
        INNER JOIN
        student_class sc ON p.id = sc.student_id
        INNER JOIN
        class c ON sc.class_id = c.id
        WHERE
        p.role_type = 1  -- 筛选角色类型为学生（1-学生）
        <if test="nameKeyword != null">
            AND p.name LIKE CONCAT('%', #{nameKeyword}, '%')
        </if>
        <if test="classKeyword != null">
            AND c.class_name LIKE CONCAT('%', #{classKeyword}, '%')
        </if>

        ORDER BY p.id DESC </select>
</mapper>